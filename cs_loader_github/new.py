from ctypes import *
import binascii
import sys


b = cdll.LoadLibrary('./new.so')



def decompress_block(data, dst_len=0):
	buf = create_string_buffer(data)
	cb = c_int(len(buf)-1)
	if dst_len == 0:
		cbOut = len(buf)*10
	else:
		cbOut = dst_len
	buf1 = create_string_buffer(0x4038) #table
        buf2 = create_string_buffer(0x2000) #output
	cbOut = c_int(cbOut)
	retval = b.sub_140001020(byref(buf1), byref(buf), cb, byref(buf2), 0x2000)
	return buf2.raw


data = open(sys.argv[1], 'rb').read()
t = decompress_block(data)
t2 = t.split('\x00')[0]
t2 = ''.join(t2.split('\\x'))
print(binascii.unhexlify(t2))
